<?xml version='1.0' encoding='utf-8'?>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:epub="http://www.idpf.org/2007/ops" lang="en">

<head>
  <title>More Hands-on Microservices</title>
  <link href="../css/springer_epub.css" rel="styleSheet" type="text/css"/>
</head>

<body>

  <div epub:type="chapter" role="doc-chapter">

    <div class="ChapterContextInformation">

      <div class="ContextInformation" id="b979-8-8688-0555-4_2"><div class="ChapterCopyright">© The Author(s), under exclusive license to APress Media, LLC, part of Springer Nature 2024</div><span class="ContextInformationAuthorEditorNames">B. A. Christudas</span><span class="ContextInformationBookTitles"><span class="BookTitle">Java Microservices and Containers in the Cloud</span></span><span class="ChapterDOI"><a href="https://doi.org/10.1007/979-8-8688-0555-4_2">https://doi.org/10.1007/979-8-8688-0555-4_2</a></span></div>

    </div>

    <!--Begin Abstract-->

    <div class="MainTitleSection">

      <h1 class="ChapterTitle" lang="en">2. More Hands-on Microservices</h1>

    </div>

    <div class="AuthorGroup">

      <div class="AuthorNames"><span class="Author"><span class="AuthorName">Binildas A. Christudas</span><sup><a href="#Aff2">1</a> <span class="ContactIcon"> </span></sup></span></div>

      <div class="Affiliations">

        <div class="Affiliation" id="Aff2"><span class="AffiliationNumber">(1)</span><div class="AffiliationText">NBCRA 45, Christbin, Thiruvananthapuram, Kerala, India</div></div>

        <div class="ClearBoth"> </div>

      </div>

    </div>

    <!--End Abstract-->

    <div class="Fulltext">

      <p class="Para" id="Par2">You coded your first and simplest microservice in the last chapter. That example used a simple data structure as an in-memory database. This chapter extends that example by creating a few more microservices, each one in increasing order of complexity. This will enable you to build on your prior learnings. You will interact with a few real databases and firm up your knowledge of the ports and adapters architecture introduced in Chapter <span class="ExternalRef"><a href="Capítulo-03.html"><span class="RefSource">1</span></a></span>.</p>

      <p class="Para" id="Par3">This chapter is fully hands-on, but the examples are still simple, so you don’t have to understand complex business or entity relationships. Instead, the examples emphasize on learning technologies and architecture variations.</p>

      <div class="Para" id="Par4">This chapter covers the following <span id="ITerm1">concepts</span>, each with running examples:<div class="UnorderedList"><ul class="UnorderedListMarkBullet"><li><p class="Para" id="Par5">First, you will enhance the microservice example from the previous chapter to interact with a MongoDB.</p></li><li><p class="Para" id="Par6">I introduce the Spring Cloud next.</p></li><li><p class="Para" id="Par7">I move on to a discussion of HAL and HATEOAS.</p></li><li><p class="Para" id="Par8">As a final example, you will implement a HATEOAS-based microservice using Spring Boot.</p></li></ul></div></div>

      <section class="Section1 RenderAsSection1" id="Sec1">

        <h2 class="Heading">Microservices Using MongoDB and RestTemplate</h2>

        <p class="Para" id="Par9">As mentioned, you will enhance the microservice you created in the last chapter. You will have two microservices—a consumer and a provider microservice—communicating each other using the REST protocol. The provider microservice also <span id="ITerm2">interacts</span> with a NoSQL database, MongoDB.</p>

        <section class="Section2 RenderAsSection2" id="Sec2">

          <h3 class="Heading">Design the Microservices</h3>

          <div class="Para" id="Par10">This example uses the hexagonal microservice design depicted in Figure <span class="ExternalRef"><a href="Capítulo-03.html#Fig13"><span class="RefSource">1-13</span></a></span> in Chapter <span class="ExternalRef"><a href="Capítulo-03.html"><span class="RefSource">1</span></a></span>. This is shown again in Figure <span class="InternalRef"><a href="#Fig1">2-1</a></span>.<figure class="Figure" id="Fig1"><div class="MediaObject" id="MO1"><img alt="" aria-describedby="d64e240" src="../images/619782_1_En_2_Chapter/Imagem-024.jpg" style="width:35.15em"/><div class="TextObject" id="d64e240"><p class="Para" id="Par102">A model diagram connects the end user and browser to product-web-microservice via incoming command or query, rest A P I, product rest controller, and outgoing command or query with rest template, and product-service-microservice via incoming command or query, rest A P I, controller, product repository, product entity, and Mongo D B.</p></div></div><figcaption class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Figure 2-1</span><p class="SimplePara">Consumer and provider microservice <span id="ITerm3">design</span></p></div></figcaption></figure></div>

          <p class="Para" id="Par11">Both of the microservices shown in Figure <span class="InternalRef"><a href="#Fig1">2-1</a></span> use HTTP ports at the REST interfaces, which are specification of how a user’s browser or some other HTTP client can use the application core. These ports (interfaces) belong inside the business logic of the respective microservices as REST controllers. An adapter is provided by Spring runtime, which provides the functionality promised by the REST interface. A request from the browser will hit the Product Web microservice, which is the consumer microservice. The Product Web microservice doesn’t perform any business logic; instead, it delegates the calls to the Product Server microservice, which is the provider microservice. The objective of keeping the Product Web microservice simple is to demonstrate how to initiate inter-microservice communication so that you can use and extend this template for real-world cases.</p>

          <p class="Para" id="Par12">The <span class="EmphasisFontCategoryNonProportional ">RestTemplate</span> in the Product Web microservice is another port, which again is nothing more than a specification on how it is used by the application core. A concrete-driven adapter that implements the <span class="EmphasisFontCategoryNonProportional ">RestTemplate</span> <span id="ITerm4">port</span> is injected into the application core by Spring wherever and wherever the port is required (type-hinted).</p>

          <p class="Para" id="Par13">The <span class="EmphasisFontCategoryNonProportional ">Product</span> entity fulfills the application core in the Product Server microservice. Here again, I avoided the typical layering of service and component stereotype classes to keep the overall complexity of the example simple.</p>

          <p class="Para" id="Par14"><span class="EmphasisFontCategoryNonProportional ">ProductRepository</span> is the third port used by the Product Server microservice. The purpose of the Product Server microservice is to persist data. So you create a persistence interface that meets its needs, with methods to do CRUD operations in a NoSQL collection using the ID of the entity. At that point, whenever and wherever the application needs to execute CRUD operations, the application core will need an object that implements the persistence interface that you defined, which is supplied by Spring runtime.</p>

        </section>

        <section class="Section2 RenderAsSection2" id="Sec3">

          <h3 class="Heading">Code Organization</h3>

          <div class="Para" id="Par15">The source <span id="ITerm5">code</span> for this book is available on GitHub via the book’s product page, located at <span class="ExternalRef"><a href="http://www.apress.com/9798868805547"><span class="RefSource"><span class="EmphasisFontCategoryNonProportional ">www.apress.com/9798868805547</span></span></a></span>. The code for the example is organized as shown in Listing <span class="InternalRef"><a href="#PC1">2-1</a></span>, inside the <span class="EmphasisFontCategoryNonProportional ">ch02\ch02-01</span> folder. This follows the standard Maven structure, so <span class="EmphasisFontCategoryNonProportional ">pom.xml</span> is in the root of the directory.<div class="ProgramCode" id="PC1"><div class="LineGroup"><div class="FixedLine">├── 01-ProductServer</div><div class="FixedLine">│   ├── pom.xml</div><div class="FixedLine">│   └── src</div><div class="FixedLine">│       └── main</div><div class="FixedLine">│           ├── java</div><div class="FixedLine">│           │   └── com</div><div class="FixedLine">│           │       └── acme</div><div class="FixedLine">│           │           └── ecom</div><div class="FixedLine">│           │               └── product</div><div class="FixedLine">│           │                   ├── EcomProductMicroApp.java</div><div class="FixedLine">│           │                   ├── InitComponent.java</div><div class="FixedLine">│           │                   ├── controller</div><div class="FixedLine">│           │                   │   └── ProdRestControl.java</div><div class="FixedLine">│           │                   ├── model</div><div class="FixedLine">│           │                   │   └── Product.java</div><div class="FixedLine">│           │                   └── repository</div><div class="FixedLine">│           │                       ├── ProductRepository.java</div><div class="FixedLine">│           │                       └── ProdRepConfig.java</div><div class="FixedLine">│           └── resources</div><div class="FixedLine">│               ├── application.properties</div><div class="FixedLine">│               └── log4j2-spring.xml</div><div class="FixedLine">├── 02-ProductWeb</div><div class="FixedLine">│   ├── pom.xml</div><div class="FixedLine">│   └── src</div><div class="FixedLine">│       └── main</div><div class="FixedLine">│           ├── java</div><div class="FixedLine">│           │   └── com</div><div class="FixedLine">│           │       └── acme</div><div class="FixedLine">│           │           └── ecom</div><div class="FixedLine">│           │               └── product</div><div class="FixedLine">│           │                   ├── EcomProdMicroApp.java</div><div class="FixedLine">│           │                   ├── InitComponent.java</div><div class="FixedLine">│           │                   ├── controller</div><div class="FixedLine">│           │                   │   ├── ProdRestControl.java</div><div class="FixedLine">│           │                   │   └── ProdRestConfig.java</div><div class="FixedLine">│           │                   └── model</div><div class="FixedLine">│           │                       ├── Product.java</div><div class="FixedLine">│           │                       └── ProductCategory.java</div><div class="FixedLine">│           └── resources</div><div class="FixedLine">│               ├── application.properties</div><div class="FixedLine">│               ├── log4j2-spring.xml</div><div class="FixedLine">│               └── static</div><div class="FixedLine">│                   ├── css</div><div class="FixedLine">│                   │   ├── app.css</div><div class="FixedLine">│                   │   └── bootstrap.css</div><div class="FixedLine">│                   ├── js</div><div class="FixedLine">│                   │   ├── app.js</div><div class="FixedLine">│                   │   ├── controller</div><div class="FixedLine">│                   │   │   └── product_controller.js</div><div class="FixedLine">│                   │   └── service</div><div class="FixedLine">│                   │       └── product_service.js</div><div class="FixedLine">│                   └── product.html</div><div class="FixedLine">└── pom.xml</div></div><div class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Listing 2-1</span><p class="SimplePara">Spring Boot Source Code Organization</p></div></div></div></div>

          <div class="FormalPara FormalParaRenderingStyle1 ParaTypeImportant" id="FPar1">

            <div class="Heading">Note</div>

            <p class="Para FirstParaInFormalPara" id="Par16">The names of a few of the Java classes in Listing <span class="InternalRef"><a href="#PC1">2-1</a></span> has been shortened for formatting purposes.</p>

          </div>

          <p class="Para" id="Par17">The <span class="EmphasisFontCategoryNonProportional ">ch02\ch02-01</span> folder contains the source code for the consumer and provider microservices. The topmost folder also contains scripts that will help you build the microservices together. There are also scripts in this folder to clean up the projects at the end.</p>

        </section>

        <section class="Section2 RenderAsSection2" id="Sec4">

          <h3 class="Heading">Understanding the Code</h3>

          <div class="Para" id="Par18">Let’s look at the provider microservice—the Product Server microservice—first. Listing <span class="InternalRef"><a href="#PC2">2-2</a></span> starts with the REST-capable HTTP port, using a Spring <span id="ITerm6"><span class="EmphasisFontCategoryNonProportional ">RestController</span></span>.<div class="ProgramCode" id="PC2"><div class="LineGroup"><div class="FixedLine">@RestController</div><div class="FixedLine">public class ProductRestController {</div></div><div class="LineGroup"><div class="FixedLine">    @Autowired</div><div class="FixedLine">    private ProductRepository productRepository;</div></div><div class="LineGroup"><div class="FixedLine">    @RequestMapping(value = "/products",</div><div class="FixedLine">        method = RequestMethod.GET,</div><div class="FixedLine">        produces = {MediaType.APPLICATION_JSON_VALUE})</div><div class="FixedLine">    public ResponseEntity&lt;List&lt;Product&gt;&gt; getAllProducts() {</div></div><div class="LineGroup"><div class="FixedLine">        List&lt;Product&gt; products = productRepository.findAll();</div><div class="FixedLine">        if(products.isEmpty()){</div><div class="FixedLine">            return new ResponseEntity&lt;List&lt;Product&gt;&gt;(</div><div class="FixedLine">                HttpStatus.NOT_FOUND);</div><div class="FixedLine">        }</div><div class="FixedLine">        List&lt;Product&gt; list = new ArrayList&lt;Product&gt; ();</div><div class="FixedLine">        for(Product product:products){</div><div class="FixedLine">            list.add(product);</div><div class="FixedLine">        }</div><div class="FixedLine">        list.forEach(item-&gt;LOGGER.debug(item.toString()));</div><div class="FixedLine">        return new ResponseEntity&lt;List&lt;Product&gt;&gt;(list,</div><div class="FixedLine">            HttpStatus.OK);</div><div class="FixedLine">    }</div><div class="FixedLine">}</div></div><div class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Listing 2-2</span><p class="SimplePara">REST Based HTTP Port for getAllProducts Product Server (ch02\ch02-01\01-ProductServer\src\main\java\com\acme\ecom\product\controller\ProductRestController.java)</p></div></div></div></div>

          <p class="Para" id="Par19"><span class="EmphasisFontCategoryNonProportional ">getAllProducts</span> is a Java method that will return a list of all products in the MongoDB database, defined through an abstract protocol and the format of delivery declared in the HTTP-based REST port. A concrete implementation of this port is then injected (or used to intercept) by Spring and used in the Controller edge in the runtime. They translate the JSON formatted Request data payload from the HTTP delivery channel into a <span class="EmphasisFontCategoryNonProportional ">getAllProducts</span> method call in the application core. To retrieve the products, <span class="EmphasisFontCategoryNonProportional ">getAllProducts</span> delegates calls to the driven port, <span class="EmphasisFontCategoryNonProportional ">ProductRepository</span>.</p>

          <p class="Para" id="Par20">The remainder of the implementation of the REST controller in the Product Server microservice is very similar to the code in Listing 1-4 in Chapter <span class="ExternalRef"><a href="Capítulo-03.html"><span class="RefSource">1</span></a></span> (with the single exception that instead of the in-memory database, the <span class="EmphasisFontCategoryNonProportional ">ProductRepository</span> <span id="ITerm7">port</span> is used to interact with a MongoDB repository), so I do not repeat the full code here.</p>

          <div class="Para" id="Par21">This example introduces the abstract port to interact with the MongoDB, as shown in Listing <span class="InternalRef"><a href="#PC3">2-3</a></span>.<div class="ProgramCode" id="PC3"><div class="LineGroup"><div class="FixedLine">@RepositoryRestResource(collectionResourceRel = "productdata", path = "productdata")</div><div class="FixedLine">public interface ProductRepository extends</div><div class="FixedLine">        MongoRepository&lt;Product, String&gt;  {</div></div><div class="LineGroup"><div class="FixedLine">    public List&lt;Product&gt; findByCode(</div><div class="FixedLine">        @Param("code") String  code);</div><div class="FixedLine">}</div></div><div class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Listing 2-3</span><p class="SimplePara">Abstract Port to MongoDB Repository (ch02\ch02-01\01-ProductServer\src\main\java\com\acme\ecom\product\repository\ProductRepository.java)</p></div></div></div></div>

          <p class="Para" id="Par22">Since this port extends <span class="EmphasisFontCategoryNonProportional ">MongoRepository</span>, all of the default CRUD method declarations are inherited by default. Therefore, you need to only declare the custom methods—<span class="EmphasisFontCategoryNonProportional ">findByCode</span> in this example.</p>

          <div class="Para" id="Par23">The code for the main class of the <span id="ITerm8">Product Server microservice</span> is shown in Listing <span class="InternalRef"><a href="#PC4">2-4</a></span>.<div class="ProgramCode" id="PC4"><div class="LineGroup"><div class="FixedLine">@SpringBootApplication</div><div class="FixedLine">public class EcomProductMicroserviceApplication {</div></div><div class="LineGroup"><div class="FixedLine">    public static void main(String[] args) {</div></div><div class="LineGroup"><div class="FixedLine">        SpringApplication.run(</div><div class="FixedLine">            EcomProductMicroserviceApplication.class, args);</div><div class="FixedLine">    }</div><div class="FixedLine">}</div></div><div class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Listing 2-4</span><p class="SimplePara">Product Server Microservice Main class (ch02\ch02-01\01-ProductServer\src\main\java\com\acme\ecom\product \EcomProductMicroserviceApplication.java)</p></div></div></div></div>

          <div class="Para" id="Par24">Listing <span class="InternalRef"><a href="#PC5">2-5</a></span> shows the Product Server microservice configuration file.<div class="ProgramCode" id="PC5"><div class="LineGroup"><div class="FixedLine">spring.data.mongodb.uri=mongodb://localhost:27017/test</div><div class="FixedLine">server.port=8081</div><div class="FixedLine">spring.application.name = product-server</div></div><div class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Listing 2-5</span><p class="SimplePara">The Product Server Microservice Config File (ch02\ch02-01\01-ProductServer\src\main\resources\application.properties)</p></div></div></div></div>

          <p class="Para" id="Par25">This URL points to the MongoDB database.</p>

          <div class="Para" id="Par26">Next, you will look at the consumer microservice, that is, the Product Web microservice. Listing <span class="InternalRef"><a href="#PC6">2-6</a></span> shows the REST-capable HTTP port, using a Spring <span id="ITerm9"><span class="EmphasisFontCategoryNonProportional ">RestController</span></span>.<div class="ProgramCode" id="PC6"><div class="LineGroup"><div class="FixedLine">@RestController</div><div class="FixedLine">public class ProductRestController{</div></div><div class="LineGroup"><div class="FixedLine">    @Value("${acme.PRODUCT_SERVICE_URL}")</div><div class="FixedLine">    private String PRODUCT_SERVICE_URL;</div></div><div class="LineGroup"><div class="FixedLine">    @Autowired</div><div class="FixedLine">    private RestTemplate restTemplate;</div></div><div class="LineGroup"><div class="FixedLine">    @RequestMapping(value = "/productsweb",</div><div class="FixedLine">        method = RequestMethod.GET,</div><div class="FixedLine">        produces = {MediaType.APPLICATION_JSON_VALUE})</div><div class="FixedLine">    public ResponseEntity&lt;List&lt;Product&gt;&gt; getAllProducts() {</div></div><div class="LineGroup"><div class="FixedLine">        ParameterizedTypeReference&lt;List&lt;Product&gt;&gt;</div><div class="FixedLine">            responseTypeRef = new ParameterizedTypeReference&lt;</div><div class="FixedLine">                List&lt;Product&gt;&gt;() {};</div><div class="FixedLine">        ResponseEntity&lt;List&lt;Product&gt;&gt; entity =</div><div class="FixedLine">            restTemplate.exchange(PRODUCT_SERVICE_URL,</div><div class="FixedLine">                HttpMethod.GET, (HttpEntity&lt;Product&gt;) null,</div><div class="FixedLine">                responseTypeRef);</div><div class="FixedLine">        List&lt;Product&gt; productList = entity.getBody();</div><div class="FixedLine">        return new ResponseEntity&lt;List&lt;Product&gt;&gt;(productList,</div><div class="FixedLine">            HttpStatus.OK);</div><div class="FixedLine">    }</div><div class="FixedLine">}</div></div><div class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Listing 2-6</span><p class="SimplePara">REST Based HTTP Port for getAllProducts Product Web (ch02\ch02-01\02-ProductWeb\src\main\java\com\acme\ecom\product\controller\ProductRestController.java)</p></div></div></div></div>

          <div class="Para" id="Par27">The value for <span class="EmphasisFontCategoryNonProportional ">PRODUCT_SERVICE_URL</span> is configured in <span class="EmphasisFontCategoryNonProportional ">application.properties</span> to point to the URL for the provider microservice, as follows:<div class="ProgramCode" id="PC7"><div class="LineGroup"><div class="FixedLine">acme.PRODUCT_SERVICE_URL = http://localhost:8081/products</div></div></div></div>

          <div class="Para" id="Par28">The adapter to realize the inter-microservice communication is defined in the Product Web microservice by defining the <span class="EmphasisFontCategoryNonProportional ">RestTemplate</span> configured in Spring in the configuration class, as shown in Listing <span class="InternalRef"><a href="#PC8">2-7</a></span>.<div class="ProgramCode" id="PC8"><div class="LineGroup"><div class="FixedLine">@Bean</div><div class="FixedLine">    RestTemplate restTemplate() {</div><div class="FixedLine">        ObjectMapper mapper = new ObjectMapper();</div><div class="FixedLine">        mapper.configure(</div><div class="FixedLine">            DeserializationFeature.FAIL_ON_UNKNOWN_PROPERTIES,</div><div class="FixedLine">                false);</div><div class="FixedLine">        MappingJackson2HttpMessageConverter converter =</div><div class="FixedLine">            new MappingJackson2HttpMessageConverter();</div><div class="FixedLine">        converter.setSupportedMediaTypes(</div><div class="FixedLine">            MediaType.parseMediaTypes("application/json"));</div><div class="FixedLine">        converter.setObjectMapper(mapper);</div><div class="FixedLine">        return new RestTemplate(Arrays.asList(converter));</div><div class="FixedLine">    }</div><div class="FixedLine">}</div></div><div class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Listing 2-7</span><p class="SimplePara"><span id="ITerm10">REST Template Configuration</span> in Product Web ch02\ch02-01\02-ProductWeb\src\main\java\com\acme\ecom\product\controller\ProductRestControllerConfiguration.java)</p></div></div></div></div>

          <p class="Para" id="Par29">From now on, whenever the Product Web microservice needs to communicate to the external API of the Product Server microservice, you need an object that implements the <span class="EmphasisFontCategoryNonProportional ">RestTemplate</span> interface that you defined, and Spring provides you with that.</p>

          <div class="Para" id="Par30">The rest of the implementation of the Product Web microservice REST controller is shown in Listing <span class="InternalRef"><a href="#PC9">2-8</a></span>.<div class="ProgramCode" id="PC9"><div class="LineGroup"><div class="FixedLine">public class ProductRestController{</div></div><div class="LineGroup"><div class="FixedLine">    @RequestMapping(value = "/productsweb/{productId}",</div><div class="FixedLine">        method = RequestMethod.GET,</div><div class="FixedLine">        produces = MediaType.APPLICATION_JSON_VALUE)</div><div class="FixedLine">    public ResponseEntity&lt;Product&gt; getProduct(@PathVariable(</div><div class="FixedLine">            "productId") String productId) {</div></div><div class="LineGroup"><div class="FixedLine">        String uri = PRODUCT_SERVICE_URL + "/" + productId;</div><div class="FixedLine">        Product product = restTemplate.getForObject(uri,</div><div class="FixedLine">            Product.class);</div><div class="FixedLine">        return new ResponseEntity&lt;Product&gt;(product,</div><div class="FixedLine">            HttpStatus.OK);</div><div class="FixedLine">    }</div></div><div class="LineGroup"><div class="FixedLine">    @RequestMapping(value = "/productsweb",</div><div class="FixedLine">        method = RequestMethod.POST,</div><div class="FixedLine">        produces = MediaType.APPLICATION_JSON_VALUE)</div><div class="FixedLine">    public ResponseEntity&lt;Product&gt; addProduct(</div><div class="FixedLine">            @RequestBody Product product) {</div></div><div class="LineGroup"><div class="FixedLine">        Product productNew = restTemplate.postForObject(</div><div class="FixedLine">            PRODUCT_SERVICE_URL,</div><div class="FixedLine">            product, Product.class);</div><div class="FixedLine">        return new ResponseEntity&lt;Product&gt;(product,</div><div class="FixedLine">            HttpStatus.OK);</div><div class="FixedLine">    }</div></div><div class="LineGroup"><div class="FixedLine">    @RequestMapping(value = "/productsweb/{productId}",</div><div class="FixedLine">        method = RequestMethod.DELETE,</div><div class="FixedLine">        produces = MediaType.APPLICATION_JSON_VALUE)</div><div class="FixedLine">    public ResponseEntity&lt;Product&gt; deleteProduct(</div><div class="FixedLine">            @PathVariable("productId")String productId) {</div></div><div class="LineGroup"><div class="FixedLine">        restTemplate.delete(PRODUCT_SERVICE_URL + "/" +</div><div class="FixedLine">            productId);</div><div class="FixedLine">        return new ResponseEntity&lt;Product&gt;(</div><div class="FixedLine">            HttpStatus.NO_CONTENT);</div><div class="FixedLine">    }</div></div><div class="LineGroup"><div class="FixedLine">    @RequestMapping(value = "/productsweb/{productId}",</div><div class="FixedLine">        method = RequestMethod.PUT,</div><div class="FixedLine">        produces = MediaType.APPLICATION_JSON_VALUE)</div><div class="FixedLine">    public ResponseEntity&lt;Product&gt; updateProduct(</div><div class="FixedLine">            @PathVariable("productId")String productId,</div><div class="FixedLine">            @RequestBody Product product) {</div></div><div class="LineGroup"><div class="FixedLine">        String uri = PRODUCT_SERVICE_URL + "/" + productId;</div><div class="FixedLine">        restTemplate.put(uri, product, Product.class);</div><div class="FixedLine">        Product updatedProduct = restTemplate.getForObject(</div><div class="FixedLine">            uri, Product.class);</div><div class="FixedLine">        return new ResponseEntity&lt;Product&gt;(updatedProduct,</div><div class="FixedLine">            HttpStatus.OK);</div><div class="FixedLine">    }</div><div class="FixedLine">}</div></div><div class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Listing 2-8</span><p class="SimplePara">REST based HTTP Port for CRUD <span id="ITerm11">methods</span> of Product Web (ch02\ch02-01\02-ProductWeb\src\main\java\com\acme\ecom\product\controller\ProductRestController.java)</p></div></div></div></div>

          <p class="Para" id="Par31">Given a <span class="EmphasisFontCategoryNonProportional ">productId</span>, the <span class="EmphasisFontCategoryNonProportional ">getProduct</span> method will retrieve the details of a specific product. <span class="EmphasisFontCategoryNonProportional ">addProduct</span> will create a new product and <span class="EmphasisFontCategoryNonProportional ">deleteProduct</span> will remove a product from the MongoDB database. <span class="EmphasisFontCategoryNonProportional ">updateProduct</span> will update a product with a new set of values.</p>

        </section>

        <section class="Section2 RenderAsSection2" id="Sec5">

          <h3 class="Heading">Build and Run the Microservice</h3>

          <div class="Para" id="Par32">The <span class="EmphasisFontCategoryNonProportional ">ch02\ch02-01</span> folder contains the Maven scripts required to build these examples. As a first step, you need to bring up the MongoDB server. Refer to Appendix B to learn how to set up a <span id="ITerm12">MongoDB server</span> and bring it up. You need to execute the commands shown in Listing <span class="InternalRef"><a href="#PC10">2-9</a></span> to bring up MongoDB.<div class="ProgramCode" id="PC10"><div class="LineGroup"><div class="FixedLine">(base) binildass-MBP:bin binil$ pwd</div><div class="FixedLine">/Users/binil/Applns/mongodb/mongodb-macos-x86_64-4.2.8/bin</div><div class="FixedLine">(base) binildass-MBP:bin binil$ mongod --dbpath /usr/local/var/mongodb --logpath /usr/local/var/log/mongodb/mongo.log</div></div><div class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Listing 2-9</span><p class="SimplePara">Bringing Up the MongoDB Server</p></div></div></div></div>

          <div class="Para" id="Par33">Next, open a command <span id="ITerm13">terminal</span> and go to the <span class="EmphasisFontCategoryNonProportional ">ch02\ch02-01</span> folder. Execute the commands shown in Listing <span class="InternalRef"><a href="#PC11">2-10</a></span> to build the microservices together.<div class="ProgramCode" id="PC11"><div class="LineGroup"><div class="FixedLine">(base) binildass-MBP:ch02-01 binil$ pwd</div><div class="FixedLine">/Users/binil/binil/code/mac/mybooks/docker-03/ch02/ch02-01</div><div class="FixedLine">binildass-MacBook-Pro:ch02-01 binil$ sh make.sh</div><div class="FixedLine">[INFO] Scanning for projects...</div><div class="FixedLine">[INFO] ----------------------------------------------------</div><div class="FixedLine">[INFO] Reactor Build Order:</div><div class="FixedLine">[INFO]</div><div class="FixedLine">[INFO] Ecom-Product-Server-Microservice              [jar]</div><div class="FixedLine">[INFO] Ecom-Product-Web-Microservice                 [jar]</div><div class="FixedLine">[INFO] Ecom                                          [pom]</div><div class="FixedLine">[INFO]</div><div class="FixedLine">...</div><div class="FixedLine">[INFO]</div><div class="FixedLine">[INFO] Ecom-Product-Server-Microservice  SUCCESS [  1.834 s]</div><div class="FixedLine">[INFO] Ecom-Product-Web-Microservice ... SUCCESS [  0.425 s]</div><div class="FixedLine">[INFO] Ecom ............................ SUCCESS [  0.040 s]</div><div class="FixedLine">[INFO] -----------------------------------------------------</div><div class="FixedLine">[INFO] BUILD SUCCESS</div><div class="FixedLine">[INFO] -----------------------------------------------------</div><div class="FixedLine">[INFO] Total time:  2.491 s</div><div class="FixedLine">[INFO] Finished at: 2023-12-20T08:26:08+05:30</div><div class="FixedLine">[INFO] -----------------------------------------------------</div><div class="FixedLine">binildass-MacBook-Pro:ch02-01 binil$</div></div><div class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Listing 2-10</span><p class="SimplePara">Building and Running the Microservices</p></div></div></div></div>

          <div class="Para" id="Par34">Alternatively, you can take two command terminals and change the directory to the top-level folder of the microservices. First, build and run the Product Server microservice using the <span class="EmphasisFontCategoryNonProportional ">make.sh</span> and the <span class="EmphasisFontCategoryNonProportional ">run.sh</span> scripts, as shown in Listing <span class="InternalRef"><a href="#PC12">2-11</a></span>.<div class="ProgramCode" id="PC12"><div class="LineGroup"><div class="FixedLine">(base) binildass-MacBook-Pro:01-ProductServer binil$ pwd</div><div class="FixedLine">/Users/binil/binil/code/mac/mybooks/docker-03/ch02/ch02-01/01-ProductServer</div><div class="FixedLine">binildass-MacBook-Pro:01-ProductServer binil$ sh make.sh</div><div class="FixedLine">[INFO] Scanning for projects...</div><div class="FixedLine">[INFO]</div><div class="FixedLine">...</div><div class="FixedLine">[INFO] ----------------------------------------------------</div><div class="FixedLine">[INFO] BUILD SUCCESS</div><div class="FixedLine">[INFO] ----------------------------------------------------</div><div class="FixedLine">[INFO] Total time:  2.136 s</div><div class="FixedLine">[INFO] Finished at: 2023-12-20T08:18:18+05:30</div><div class="FixedLine">[INFO] ----------------------------------------------------</div><div class="FixedLine">binildass-MacBook-Pro:01-ProductServer binil$</div></div><div class="LineGroup"><div class="FixedLine">binildass-MacBook-Pro:01-ProductServer binil$ sh run.sh</div></div><div class="LineGroup"><div class="FixedLine">  .   ____          _            __ _ _</div><div class="FixedLine"> /\\ / ___'_ __ _ _(_)_ __  __ _ \ \ \ \</div><div class="FixedLine">( ( )\___ | '_ | '_| | '_ \/ _` | \ \ \ \</div><div class="FixedLine"> \\/  ___)| |_)| | | | | || (_| |  ) ) ) )</div><div class="FixedLine">  '  |____| .__|_| |_|_| |_\__, | / / / /</div><div class="FixedLine"> =========|_|==============|___/=/_/_/_/</div><div class="FixedLine"> :: Spring Boot ::                (v3.2.0)</div></div><div class="LineGroup"><div class="FixedLine">2023-12-20 08:21:18 INFO  Start.log:50 - Starting EcomProd...</div><div class="FixedLine">2023-12-20 08:21:18 DEBUG Start.log:51 - Run with Boot v3.2.0</div><div class="FixedLine">2023-12-20 08:21:18 INFO  SpringApp.log:653 - No active ...</div><div class="FixedLine">2023-12-20 08:21:19 INFO  InitComponent.init:45 - Start</div><div class="FixedLine">2023-12-20 08:21:19 INFO  InitComponent.init:67 - End</div><div class="FixedLine">2023-12-20 08:21:20 INFO  Start.log:56 - Started EcomProd...</div></div><div class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Listing 2-11</span><p class="SimplePara">Building and Running the Product Server <span id="ITerm14">Microservice</span> Using Scripts</p></div></div></div></div>

          <div class="Para" id="Par35">Next, build and run the Product Web microservice, as shown in Listing <span class="InternalRef"><a href="#PC13">2-12</a></span>.<div class="ProgramCode" id="PC13"><div class="LineGroup"><div class="FixedLine">(base) binildass-MacBook-Pro:02-ProductWeb binil$ pwd</div><div class="FixedLine">/Users/binil/binil/code/mac/mybooks/docker-03/ch02/ch02-01/02-ProductWeb</div><div class="FixedLine">binildass-MacBook-Pro:02-ProductWeb binil$ sh make.sh</div><div class="FixedLine">...</div><div class="FixedLine">binildass-MacBook-Pro:02-ProductWeb binil$ sh run.sh</div><div class="FixedLine">[INFO] Scanning for projects...</div><div class="FixedLine">[INFO]</div><div class="FixedLine">...</div><div class="FixedLine">2023-12-20 08:23:46 INFO  SpringApp.log:653 - No active ...</div><div class="FixedLine">2023-12-20 08:23:47 INFO  InitComponent.init:37 - Start</div><div class="FixedLine">2023-12-20 08:23:47 DEBUG InitComponent.init:39 - Do Nothing</div><div class="FixedLine">2023-12-20 08:23:47 INFO  InitComponent.init:41 - End</div><div class="FixedLine">2023-12-20 08:23:47 INFO  StartupInfoLogger.logStarted:56 - Started EcomProduct...</div></div><div class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Listing 2-12</span><p class="SimplePara">Building and Running the Product Web Microservice Using <span id="ITerm15">Scripts</span></p></div></div></div></div>

          <p class="Para" id="Par36">Now that both microservices are up and running, you can test the microservices.</p>

        </section>

        <section class="Section2 RenderAsSection2" id="Sec6">

          <h3 class="Heading">Testing the Microservices</h3>

          <div class="Para" id="Par37">Once both <span id="ITerm16">microservices</span> are up and running, you can inspect your MongoDB server using the <span class="EmphasisFontCategoryNonProportional ">mongo</span> terminal to make sure the Product Server microservice has inserted a few products into the MongoDB server during the microservice startup (see Listing <span class="InternalRef"><a href="#PC14">2-13</a></span>). Refer to Appendix B to learn how to use the <span class="EmphasisFontCategoryNonProportional ">mongo</span> terminal.<div class="ProgramCode" id="PC14"><div class="LineGroup"><div class="FixedLine">&gt; show collections</div><div class="FixedLine">product</div><div class="FixedLine">&gt; db.product.find()</div><div class="FixedLine">{ "_id" : ObjectId("619e1a5b21b6e123a375641c"), "name" : "Kamsung D3", "code" : "KAMSUNG-TRIOS", "title" : "Kamsung Trios 12 inch , black , 12 px ....", "price" : 12000, "_class" : "com.acme.ecom.product.model.Product" }</div><div class="FixedLine">{ "_id" : ObjectId("619e1a5b21b6e123a375641d"), "name" : "Lokia Pomia", "code" : "LOKIA-POMIA", "title" : "Lokia 12 inch , white , 14px ....", "price" : 9000, "_class" : "com.acme.ecom.product.model.Product" }</div><div class="FixedLine">&gt;</div></div><div class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Listing 2-13</span><p class="SimplePara">Inspecting the MongoDB Server Using a Mongo Shell</p></div></div></div></div>

          <p class="Para" id="Par38">When all is set, you can access the web application using your browser and pointing to <span class="EmphasisFontCategoryNonProportional ">http://localhost:8080/product.html</span>.</p>

          <p class="Para" id="Par39">To test the CRUD operations, follow the instructions described in the subsection, “Test the Microservices Using UI” in the last section of Chapter <span class="ExternalRef"><a href="Capítulo-03.html"><span class="RefSource">1</span></a></span>, titled “Your First Java Microservice.”</p>

        </section>

      </section>

      <section class="Section1 RenderAsSection1" id="Sec7">

        <h2 class="Heading">Microservices Using Spring Cloud</h2>

        <p class="Para" id="Par40"><span id="ITerm17">Spring Cloud</span> is built over Spring Boot. Spring Cloud provides many common patterns in distributed, microservices ecosystems that can help you integrate the core services as a set of loosely coupled services. Spring Cloud also provides many powerful tools that enhance the behavior of Spring Boot applications to implement those patterns. This section looks at one such pattern with code so that you can appreciate the benefits it provides.</p>

        <section class="Section2 RenderAsSection2" id="Sec8">

          <h3 class="Heading">Design the Microservices</h3>

          <div class="Para" id="Par41">This section slightly modifies the previous microservice example to introduce Spring <span id="ITerm18">Cloud</span>.<figure class="Figure" id="Fig2"><div class="MediaObject" id="MO2"><img alt="" aria-describedby="d64e1238" src="../images/619782_1_En_2_Chapter/Imagem-025.jpg" style="width:35.15em"/><div class="TextObject" id="d64e1238"><p class="Para" id="Par103">A model diagram connects the end user and browser to product-web-microservice via incoming command, rest A P I, product rest controller, product service proxy, product service, and outgoing command with feign client, and product-service-microservice via incoming command, rest A P I, controller, product repository, product entity, and Mongo D B.</p></div></div><figcaption class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Figure 2-2</span><p class="SimplePara">Microservices design with Spring Cloud Feign client</p></div></figcaption></figure></div>

          <p class="Para" id="Par42">As explained in the previous example, in both microservices shown in Figure <span class="InternalRef"><a href="#Fig2">2-2</a></span>, you use <span id="ITerm19">HTTP ports</span> at the REST interfaces, which specify how a user’s browser or another HTTP client can use the application core. These ports (interfaces) belong inside the business logic of the respective microservices as REST controllers. Requests from the browser will hit the Product Web microservice, which is the consumer microservice. The Product Web microservice doesn’t perform any business logic; instead, it delegates calls to the Product Server microservice, the provider microservice.</p>

          <p class="Para" id="Par43">The <span class="EmphasisFontCategoryNonProportional ">FeignClient</span> port in the Product Web microservice is another port, which again is nothing more than a specification of how it is used by the application core. A concrete driven adapter that implements the <span class="EmphasisFontCategoryNonProportional ">FeignClient</span> port is injected into the application core by Spring Cloud wherever and wherever the port is required (type-hinted).<span id="ITerm20"></span></p>

          <p class="Para" id="Par44">The <span class="EmphasisFontCategoryNonProportional ">Product</span> entity fulfills the application core in the Product Server microservice.</p>

          <p class="Para" id="Par45">The rest of the ports and adapters in the Product Server microservice function exactly similar as the previous example.</p>

        </section>

        <section class="Section2 RenderAsSection2" id="Sec9">

          <h3 class="Heading">Understanding the Code</h3>

          <div class="Para" id="Par46">The <span id="ITerm21">source code</span> for this book is available on GitHub via the book’s product page, located at <span class="ExternalRef"><a href="http://www.apress.com/9798868805547"><span class="RefSource"><span class="EmphasisFontCategoryNonProportional ">www.apress.com/9798868805547</span></span></a></span>. The source code for this example is organized inside the <span class="EmphasisFontCategoryNonProportional ">ch02\ch02-02</span> folder. The source code is similar to the previous example. The Product Server microservice is similar; however, there are a few changes in the Product Web microservices, which you look at here. Instead of the <span class="EmphasisFontCategoryNonProportional ">RestTemplate</span>, this example uses <span class="EmphasisFontCategoryNonProportional ">FeignClient</span>. Listing <span class="InternalRef"><a href="#PC15">2-14</a></span> shows how to specify <span class="EmphasisFontCategoryNonProportional ">FeignClient</span>.<div class="ProgramCode" id="PC15"><div class="LineGroup"><div class="FixedLine">public interface ProductService {</div></div><div class="LineGroup"><div class="FixedLine">    @RequestMapping(value = "/products",</div><div class="FixedLine">        method = RequestMethod.GET,</div><div class="FixedLine">        produces = MediaType.APPLICATION_JSON_VALUE)</div><div class="FixedLine">    public ResponseEntity&lt;Resources&lt;Resource&lt;Product&gt;&gt;&gt;</div><div class="FixedLine">        getAllProducts();</div></div><div class="LineGroup"><div class="FixedLine">    @RequestMapping(value = "/products/{productId}",</div><div class="FixedLine">        method = RequestMethod.GET,</div><div class="FixedLine">        produces = MediaType.APPLICATION_JSON_VALUE)</div><div class="FixedLine">    public ResponseEntity&lt;Resource&lt;Product&gt;&gt; getProduct(</div><div class="FixedLine">        @PathVariable("productId") String productId);</div></div><div class="LineGroup"><div class="FixedLine">    @RequestMapping(value = "/products",</div><div class="FixedLine">        method = RequestMethod.POST,</div><div class="FixedLine">        produces = MediaType.APPLICATION_JSON_VALUE)</div><div class="FixedLine">    public ResponseEntity&lt;Resource&lt;Product&gt;&gt; addProduct(</div><div class="FixedLine">        @RequestBody Product product);</div></div><div class="LineGroup"><div class="FixedLine">    @RequestMapping(value = "/products/{productId}",</div><div class="FixedLine">        method = RequestMethod.DELETE,</div><div class="FixedLine">        produces = MediaType.APPLICATION_JSON_VALUE)</div><div class="FixedLine">    public ResponseEntity&lt;Resource&lt;Void&gt;&gt; deleteProduct(</div><div class="FixedLine">        @PathVariable("productId") String productId);</div><div class="FixedLine"><span id="ITerm22"></span></div><div class="FixedLine">    @RequestMapping(value = "/products/{productId}",</div><div class="FixedLine">        method = RequestMethod.PUT,</div><div class="FixedLine">        produces = MediaType.APPLICATION_JSON_VALUE)</div><div class="FixedLine">    public ResponseEntity&lt;Resource&lt;Product&gt;&gt; updateProduct(</div><div class="FixedLine">        @PathVariable("productId") String productId ,</div><div class="FixedLine">        @RequestBody Product product);</div><div class="FixedLine">}</div></div><div class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Listing 2-14</span><p class="SimplePara">The <span id="ITerm23">Service Interface</span> for the Product Server Microservice (ch02\ch02-02\02-ProductWeb\src\main\java\com\acme\ecom\product\api\ProductService.java)</p></div></div></div></div>

          <div class="Para" id="Par47">The first thing you’ll do here is define a service interface, as shown in Listing <span class="InternalRef"><a href="#PC15">2-14</a></span>. Based on this service interface, you can declare an abstract <span class="EmphasisFontCategoryNonProportional ">FeignClient</span>, which is a declarative web service client. The nice thing about using <span class="EmphasisFontCategoryNonProportional ">Feign</span> is that you don’t have to write any code for calling the service, other than an interface definition, as shown in Listing <span class="InternalRef"><a href="#PC16">2-15</a></span>.<div class="ProgramCode" id="PC16"><div class="LineGroup"><div class="FixedLine">@FeignClient(name="the-name", url = "http://localhost:8081")</div><div class="FixedLine">public interface ProductServiceProxy extends ProductService{</div></div><div class="LineGroup"><div class="FixedLine">}</div></div><div class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Listing 2-15</span><p class="SimplePara">The Feign Client Interface for the Product Server Microservice (ch02\ch02-02\02-ProductWeb\src\main\java\com\acme\ecom\product\client\ProductServiceProxy.java)</p></div></div></div></div>

          <p class="Para" id="Par48">A name must be specified for all clients, which is the name of the service with the optional protocol prefix.</p>

          <div class="Para" id="Par49">You then declare this <span class="EmphasisFontCategoryNonProportional ">FeignClient</span> in <span class="EmphasisFontCategoryNonProportional ">pom.xml</span>, as shown in Listing <span class="InternalRef"><a href="#PC17">2-16</a></span>.<div class="ProgramCode" id="PC17"><div class="LineGroup"><div class="FixedLine">&lt;dependencies&gt;</div><div class="FixedLine">    &lt;dependency&gt;</div><div class="FixedLine">        &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;</div><div class="FixedLine">        &lt;artifactId&gt;</div><div class="FixedLine">            spring-cloud-starter-openfeign</div><div class="FixedLine">        &lt;/artifactId&gt;</div><div class="FixedLine">        &lt;version&gt;4.1.0&lt;/version&gt;</div><div class="FixedLine">    &lt;/dependency&gt;</div><div class="FixedLine">&lt;/dependencies&gt;</div></div><div class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Listing 2-16</span><p class="SimplePara">The Feign Client Dependency in Maven (ch02\ch02-02\02-ProductWeb\pom.xml)</p></div></div></div></div>

          <div class="Para" id="Par50">You can use application properties to configure <span class="EmphasisFontCategoryNonProportional ">Feign</span> clients; however, I am keeping this example simple, without configuring the <span class="EmphasisFontCategoryNonProportional ">Feign</span> client with such details. See Listing <span class="InternalRef"><a href="#PC18">2-17</a></span>.<div class="ProgramCode" id="PC18"><div class="LineGroup"><div class="FixedLine">feign:</div><div class="FixedLine">    client:</div><div class="FixedLine">        config:</div><div class="FixedLine">            default:</div><div class="FixedLine">                connectTimeout: 5000</div><div class="FixedLine">                readTimeout: 5000</div><div class="FixedLine">                loggerLevel: basic</div></div><div class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Listing 2-17</span><p class="SimplePara">The <span id="ITerm24">Ribbon Configuration</span> (ch02\ch02-02\02-ProductWeb\src\main\resources\application.properties)</p></div></div></div></div>

        </section>

        <section class="Section2 RenderAsSection2" id="Sec10">

          <h3 class="Heading">Build and Run the Microservice</h3>

          <div class="Para" id="Par51">The <span class="EmphasisFontCategoryNonProportional ">ch02\ch02-02</span> folder contains the Maven scripts required to <span id="ITerm25">build</span> the examples. As a first step, you need to bring up the MongoDB server. Refer to Appendix B to learn how to set up a MongoDB server and bring it up. You need to execute the commands shown in Listing <span class="InternalRef"><a href="#PC19">2-18</a></span> to bring MongoDB up.<div class="ProgramCode" id="PC19"><div class="LineGroup"><div class="FixedLine">(base) binildass-MBP:bin binil$ pwd</div><div class="FixedLine">/Users/binil/Applns/mongodb/mongodb-macos-x86_64-4.2.8/bin</div><div class="FixedLine">(base) binildass-MBP:bin binil$ mongod --dbpath /usr/local/var/mongodb --logpath /usr/local/var/log/mongodb/mongo.log</div></div><div class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Listing 2-18</span><p class="SimplePara">Bringing Up the MongoDB Server</p></div></div></div></div>

          <div class="Para" id="Par52">Next, take two command terminals and change the directory to the top-level folder of both microservices. Then, build and run the Product Server microservice using the <span class="EmphasisFontCategoryNonProportional ">make.sh</span> and the <span class="EmphasisFontCategoryNonProportional ">run.sh</span> scripts, as shown in Listing <span class="InternalRef"><a href="#PC20">2-19</a></span>.<div class="ProgramCode" id="PC20"><div class="LineGroup"><div class="FixedLine">(base) binildass-MacBook-Pro:01-ProductServer binil$ pwd</div><div class="FixedLine">/Users/binil/binil/code/mac/mybooks/docker-04/Code/ch02/ch02-02/01-ProductServer</div><div class="FixedLine">(base) binildass-MacBook-Pro:01-ProductServer binil$ sh make.sh</div><div class="FixedLine">[INFO] Scanning for projects...</div><div class="FixedLine">[INFO]</div><div class="FixedLine">...</div><div class="FixedLine">2023-12-20 09:28:00 INFO  InitializationComp.init:45 - Start</div><div class="FixedLine">2023-12-20 09:28:01 INFO  InitializationComp.init:67 - End</div><div class="FixedLine">2023-12-20 09:28:01 INFO  Start.log:56 - Started EcomProd...</div></div><div class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Listing 2-19</span><p class="SimplePara">Build and Run Product Server Microservice Using Scripts</p></div></div></div></div>

          <div class="Para" id="Par53">As a next step, build and run the Product Web microservice, as shown in Listing <span class="InternalRef"><a href="#PC21">2-20</a></span>.<div class="ProgramCode" id="PC21"><div class="LineGroup"><div class="FixedLine">(base) binildass-MacBook-Pro:02-ProductWeb binil$ pwd</div><div class="FixedLine">/Users/binil/binil/code/mac/mybooks/docker-04/Code/ch02/ch02-02/02-ProductWeb</div><div class="FixedLine">(base) binildass-MacBook-Pro:02-ProductWeb binil$ sh make.sh</div><div class="FixedLine">[INFO] Scanning for projects...</div><div class="FixedLine">...</div><div class="FixedLine">2023-12-20 09:32:00 INFO  InitComponent.init:37 - Start</div><div class="FixedLine">2023-12-20 09:32:00 DEBUG InitComponent.init:39 - Do Nothing.</div><div class="FixedLine">2023-12-20 09:32:00 INFO  InitComponent.init:41 - End</div><div class="FixedLine">2023-12-2009:32:00 INFO Start.log:56 - Started EcomProduct...</div></div><div class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Listing 2-20</span><p class="SimplePara">Build and Run Product Web Microservice Using Scripts</p></div></div></div></div>

          <p class="Para" id="Par54">Now that both microservices are up and running, you can now test the microservices.</p>

        </section>

        <section class="Section2 RenderAsSection2" id="Sec11">

          <h3 class="Heading">Testing the Microservices</h3>

          <p class="Para" id="Par55">Once both microservices are up and running, you can access the web <span id="ITerm26">application</span> using your browser. Point to this URL:</p>

          <p class="Para ParaOneEmphasisChild" id="Par56"><span class="EmphasisFontCategoryNonProportional ">http://localhost:8080/product.html</span></p>

          <p class="Para" id="Par57">To test the CRUD operations, follow the instructions described in the subsection, “Test the Microservices Using UI” in the last section of Chapter <span class="ExternalRef"><a href="Capítulo-03.html"><span class="RefSource">1</span></a></span>, titled “Your First Java Microservice.”</p>

          <p class="Para" id="Par58">Now that you have experienced the flavor of Spring Boot and Spring Cloud, the next section looks at one more important concept in REST-based microservices—<span id="ITerm27">HATEOAS and HAL</span>.</p>

        </section>

      </section>

      <section class="Section1 RenderAsSection1" id="Sec12">

        <h2 class="Heading">HATEOAS and HAL</h2>

        <p class="Para" id="Par59"><span id="ITerm28">Hypermedia as the Engine of Application State (HATEOAS)</span> is a constraint of the REST application architecture, which decouples the client from the server. Such a decoupling enables server functionality to evolve independently. The following section investigates this more, again with working examples.</p>

        <section class="Section2 RenderAsSection2" id="Sec13">

          <h3 class="Heading">HATEOAS Explained</h3>

          <p class="Para" id="Par60">HATEOAS advocates a user agent that implements HTTP to make an HTTP request of a REST API through a simple URL. Once bootstrapped, all subsequent requests the user agent may make are discovered inside the responses to each request. The media types used for these representations, and the link relations each response may contain, are standardized. The client transitions through the application states by selecting from the links within a representation or by manipulating the representation in other ways afforded by its media type. In other words, the resources available and the actions applicable to these resources are discovered, and subsequent transitions are orchestrated accordingly. In this way, RESTful interaction is driven by hypermedia, rather than out-of-band information.</p>

          <div class="Para" id="Par61">As an example, the GET request in Listing <span class="InternalRef"><a href="#PC22">2-21</a></span> fetches a product resource, requesting details in a JSON representation.<div class="ProgramCode" id="PC22"><div class="LineGroup"><div class="FixedLine">GET /productdata/61a7a51467964f330f6560fa HTTP/1.1</div><div class="FixedLine">Host: ecom.acme.com</div></div><div class="LineGroup"><div class="FixedLine">{</div><div class="FixedLine">    "productId" : "61a7a51467964f330f6560fa",</div><div class="FixedLine">    "name" : "Lokia Pomia",</div><div class="FixedLine">    "code" : "LOKIA-POMIA",</div><div class="FixedLine">    "title" : "Lokia 12 inch , white , 14px ....",</div><div class="FixedLine">    "price" : 9000.0,</div><div class="FixedLine">    "_links" : {</div><div class="FixedLine">        "self" : {</div><div class="FixedLine">            "href" : "http://localhost:8081/productdata/61"</div><div class="FixedLine">        },</div><div class="FixedLine">        "product" : {</div><div class="FixedLine">            "href" : "http://localhost:8081/productdata/61"</div><div class="FixedLine">        }</div><div class="FixedLine">        "buy" : " http://localhost:8081/productdata/61/buy"</div><div class="FixedLine">    }</div><div class="FixedLine">}</div></div><div class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Listing 2-21</span><p class="SimplePara">HATEOAS <span id="ITerm29">Response Format</span></p></div></div></div></div>

          <p class="Para" id="Par62">The response contains the follow-up link to buy the product. Later, when the stock of this product SKU is zero, the “Buy” link may not be available, or to rephrase, in its current state, the Buy link is not available. Hence, the term Engine of Application State. The possible actions vary as the state of the resource varies.</p>

          <p class="Para" id="Par63">HATEOS thus provides context-driven responses using hypermedia controls, which indicate which operations are possible, or for that matter not possible, based on the presence or absence of these links. This helps avoid transporting state-related fields between servers and clients.</p>

        </section>

        <section class="Section2 RenderAsSection2" id="Sec14">

          <h3 class="Heading">HAL Explained</h3>

          <p class="Para" id="Par64"><span id="ITerm30">Hypertext Application Language (HAL)</span> is an Internet standard (a “work in progress”) convention for defining hypermedia such as links to external resources within JSON or XML data. HAL is structured to represent elements based on the concepts of Resources and Links. Resources consist of URI links, embedded resources, your standard JSON or XML data, and non-URI links. Links have a target URI, the name of the link (referred to as <span class="EmphasisFontCategoryNonProportional ">rel</span>), and optional properties designed to be mindful of deprecation and content negotiation.</p>

          <div class="Para" id="Par65">To summarize, the <span id="ITerm31">HAL model</span> revolves around two simple concepts.<div class="UnorderedList"><ul class="UnorderedListMarkBullet"><li><div class="Para" id="Par66">Resources, which contain:<div class="UnorderedList"><ul class="UnorderedListMarkBullet"><li><p class="Para" id="Par67">Links to relevant URIs</p></li><li><p class="Para" id="Par68">Embedded resources</p></li><li><p class="Para" id="Par69">State</p></li></ul></div></div></li><li><div class="Para" id="Par70">Links:<div class="UnorderedList"><ul class="UnorderedListMarkBullet"><li><p class="Para" id="Par71">A target URI</p></li><li><p class="Para" id="Par72">A relation, or rel, to the link</p></li><li><p class="Para" id="Par73">A few other optional properties to help with depreciation, content negotiation, and so on</p></li></ul></div></div></li></ul></div></div>

          <p class="Para" id="Par74">With that little introduction, you can now get into the action with some code.</p>

        </section>

      </section>

      <section class="Section1 RenderAsSection1" id="Sec15">

        <h2 class="Heading">Microservices Using HATEAOS and HAL</h2>

        <p class="Para" id="Par75">This section uses a working example to show how things fit together. You will modify the microservices example to demonstrate both HATEOAS and HAL.</p>

        <section class="Section2 RenderAsSection2" id="Sec16">

          <h3 class="Heading">Design the Microservices</h3>

          <div class="Para" id="Par76">This example reuses the hexagonal microservice view shown in Figure <span class="InternalRef"><a href="#Fig1">2-1</a></span> and described earlier. A few of the <span id="ITerm32">differences</span> are as follows:<div class="UnorderedList"><ul class="UnorderedListMarkBullet"><li><p class="Para" id="Par77">The Product Web microservice will be enhanced to exhibit HATEOAS capability.</p></li><li><p class="Para" id="Par78">The Product Server microservice will be enhanced to demonstrate HAL.</p></li></ul></div></div>

          <p class="Para" id="Par79">You will be leveraging the Spring HATEOAS project for creating hypermedia-driven REST web services. The intention is to easily create REST representations that follow the principle of HATEOAS so the API can guide the client through the application by returning relevant information about the next potential steps, along with each response.</p>

        </section>

        <section class="Section2 RenderAsSection2" id="Sec17">

          <h3 class="Heading">Code Organization</h3>

          <div class="Para" id="Par80">The <span id="ITerm33">source code</span> for this book is available on GitHub via the book’s product page, located at <span class="ExternalRef"><a href="http://www.apress.com/9798868805547"><span class="RefSource"><span class="EmphasisFontCategoryNonProportional ">www.apress.com/9798868805547</span></span></a></span>.. The code for this example is organized as shown in Listing <span class="InternalRef"><a href="#PC23">2-22</a></span>, inside the <span class="EmphasisFontCategoryNonProportional ">ch02\ch02-03</span> folder. This follows the standard Maven structure, so <span class="EmphasisFontCategoryNonProportional ">pom.xml</span> is in the root of the directory. Code organization for the relevant portion of the Product Web microservice alone is shown, since you already saw the Product Server microservice code.<div class="ProgramCode" id="PC23"><div class="LineGroup"><div class="FixedLine">.</div><div class="FixedLine">├── 01-ProductServer</div><div class="FixedLine">│   ├── ...</div><div class="FixedLine">├── 02-ProductWeb</div><div class="FixedLine">│   ├── pom.xml</div><div class="FixedLine">│   └── src</div><div class="FixedLine">│       └── main</div><div class="FixedLine">│           ├── java</div><div class="FixedLine">│           │   └── com</div><div class="FixedLine">│           │       └── acme</div><div class="FixedLine">│           │           └── ecom</div><div class="FixedLine">│           │               └── product</div><div class="FixedLine">│           │                   ├── EcomProdWebMicroApp.java</div><div class="FixedLine">│           │                   ├── InitComponent.java</div><div class="FixedLine">│           │                   ├── controller</div><div class="FixedLine">│           │                   │   └── ProdController.java</div><div class="FixedLine">│           │                   ├── hateoas</div><div class="FixedLine">│           │                   │   └── model</div><div class="FixedLine">│           │                   │       └── Product.java</div><div class="FixedLine">│           │                   └── model</div><div class="FixedLine">│           │                       └── Product.java</div><div class="FixedLine">│           └── resources</div><div class="FixedLine">└── pom.xml</div></div><div class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Listing 2-22</span><p class="SimplePara">Spring Boot Source Code Organization</p></div></div></div></div>

          <p class="Para" id="Par81">One difference you want to note is the <span class="EmphasisFontCategoryNonProportional ">hateoas</span> subfolder in the <span class="EmphasisFontCategoryNonProportional ">Product</span> entity model. I will explain the reason for this folder in the next section.</p>

        </section>

        <section class="Section2 RenderAsSection2" id="Sec18">

          <h3 class="Heading">Understanding the Code</h3>

          <p class="Para" id="Par82">Let’s look at the changes in the provider microservice—the Product Server microservice—first.</p>

          <div class="Para" id="Par83">Much of the implementation of the REST controller in the Product Server microservice is similar to the code in Listings 1-3 and 1-4 in Chapter <span class="ExternalRef"><a href="Capítulo-03.html"><span class="RefSource">1</span></a></span>, with the exception that instead of the in-memory database, the <span class="EmphasisFontCategoryNonProportional ">ProductRepository</span> and <span class="EmphasisFontCategoryNonProportional ">ProductCategoryRepository</span> ports are used to interact with a MongoDB repository, so I do not repeat the full code here. However, this example does introduce a HAL browser. The HAL browser was created by the same person who developed HAL and it provides an in-browser GUI to traverse your REST API. It is easy to integrate a HAL browser into your Maven project by adding the relevant dependency—see Listing <span class="InternalRef"><a href="#PC24">2-23</a></span>.<div class="ProgramCode" id="PC24"><div class="LineGroup"><div class="FixedLine">&lt;dependencies&gt;</div><div class="FixedLine">    &lt;dependency&gt;</div><div class="FixedLine">        &lt;groupId&gt;org.springframework.data&lt;/groupId&gt;</div><div class="FixedLine">        &lt;artifactId&gt;spring-data-rest-hal-explorer&lt;/artifactId&gt;</div><div class="FixedLine">    &lt;/dependency&gt;</div><div class="FixedLine">&lt;/dependencies&gt;</div></div><div class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Listing 2-23</span><p class="SimplePara">HAL <span id="ITerm34">Browser Dependency</span> in Maven (ch02\ch02-03\01-ProductServer\pom.xml)</p></div></div></div></div>

          <div class="Para" id="Par84">There are a few changes in the Product Web microservice, and I will discuss them. Listing <span class="InternalRef"><a href="#PC25">2-24</a></span> shows the HATEOAS variant of the <span class="EmphasisFontCategoryNonProportional ">Product</span> <span id="ITerm35">entity</span>.<div class="ProgramCode" id="PC25"><div class="LineGroup"><div class="FixedLine">public class Product extends RepresentationModel&lt;Product&gt; {</div></div><div class="LineGroup"><div class="FixedLine">    private String productId;</div><div class="FixedLine">    private String name;</div><div class="FixedLine">    private String code;;</div><div class="FixedLine">    private String title;</div><div class="FixedLine">    private Double price;</div><div class="FixedLine">}</div></div><div class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Listing 2-24</span><p class="SimplePara">HATEOAS Variant of Product Entity (ch02\ch02-03\02-ProductWeb\src\main\java\com\acme\ecom\product\hateoas\model\Product.java)</p></div></div></div></div>

          <p class="Para" id="Par85">The <span class="EmphasisFontCategoryNonProportional ">Product</span> extends from the <span class="EmphasisFontCategoryNonProportional ">RepresentationModel</span> class to inherit the <span class="EmphasisFontCategoryNonProportional ">add()</span> method. Once you create a link, you can easily set that value to the resource representation without adding any new fields to it.</p>

          <div class="Para" id="Par86">Next, let’s look at the Controller class methods. The code in Listing <span class="InternalRef"><a href="#PC26">2-25</a></span> shows how to build HATEOAS hyperlinks based on the <span class="EmphasisFontCategoryNonProportional ">getProduct()</span> <span id="ITerm36">method</span> of the <span class="EmphasisFontCategoryNonProportional ">ProductRestController.</span><div class="ProgramCode" id="PC26"><div class="LineGroup"><div class="FixedLine">public class ProductRestController{</div></div><div class="LineGroup"><div class="FixedLine">    private static final Logger LOGGER = LoggerFactory.getLogger(ProductRestController.class);</div></div><div class="LineGroup"><div class="FixedLine">    @Value("${acme.PRODUCT_SERVICE_URL}")</div><div class="FixedLine">    private String PRODUCT_SERVICE_URL;</div></div><div class="LineGroup"><div class="FixedLine">    @Autowired</div><div class="FixedLine">    public RestTemplate restTemplate;</div></div><div class="LineGroup"><div class="FixedLine">    @Autowired</div><div class="FixedLine">    private ModelMapper modelMapper;</div></div><div class="LineGroup"><div class="FixedLine">    @RequestMapping(value = "/productsweb/{productId}",</div><div class="FixedLine">        method = RequestMethod.GET,</div><div class="FixedLine">        produces = MediaType.APPLICATION_JSON_VALUE)</div><div class="FixedLine">    public ResponseEntity&lt;com.acme.ecom.product.hateoas.model.Product&gt;</div><div class="FixedLine">            getProduct(@PathVariable("productId")</div><div class="FixedLine">                String productId) {</div></div><div class="LineGroup"><div class="FixedLine">        String uri = PRODUCT_SERVICE_URL + "/" + productId;</div><div class="FixedLine">        com.acme.ecom.product.model.Product productRetreived =</div><div class="FixedLine">            restTemplate.getForObject(uri,</div><div class="FixedLine">                com.acme.ecom.product.model.Product.class);</div><div class="FixedLine">        com.acme.ecom.product.hateoas.model.Product</div><div class="FixedLine">            productHateoas = convertEntityToHateoasEntity(</div><div class="FixedLine">                productRetreived);</div><div class="FixedLine">        productHateoas.add(linkTo(methodOn(</div><div class="FixedLine">                ProductRestController.class).getProduct(</div><div class="FixedLine">            productHateoas.getProductId())).withSelfRel());</div><div class="FixedLine">        return new ResponseEntity&lt;</div><div class="FixedLine">            com.acme.ecom.product.hateoas.model.Product&gt;(</div><div class="FixedLine">                productHateoas, HttpStatus.OK);</div><div class="FixedLine">    }</div></div><div class="LineGroup"><div class="FixedLine">    private com.acme.ecom.product.hateoas.model.Product</div><div class="FixedLine">        convertEntityToHateoasEntity(</div><div class="FixedLine">            com.acme.ecom.product.model.Product product){</div><div class="FixedLine">                return  modelMapper.map(</div><div class="FixedLine">                    product,</div><div class="FixedLine">                    com.acme.ecom.product.hateoas.</div><div class="FixedLine">                        model.Product.class);</div><div class="FixedLine">    }</div><div class="FixedLine">}</div></div><div class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Listing 2-25</span><p class="SimplePara">HATEOAS REST Controller (ch02\ch02-03\02-ProductWeb\src\main\java\com\acme\ecom\product\controller\ProductRestController.java)</p></div></div></div></div>

          <p class="Para" id="Par87"><span class="EmphasisFontCategoryNonProportional ">WebMvcLinkBuilder</span> offers great support for Spring MVC controllers. The <span class="EmphasisFontCategoryNonProportional ">methodOn()</span> obtains the method mapping by making dummy invocations of the target method on the proxy controller and sets the <span class="EmphasisFontCategoryNonProportional ">productId</span> as the path variable of the URI.</p>

          <p class="Para" id="Par88"><span class="EmphasisFontCategoryNonProportional ">WebMvcLinkBuilder</span> also simplifies building URIs by avoiding hard-coding the links. The code in Listing <span class="InternalRef"><a href="#PC26">2-25</a></span> shows how to build the product self-link using the <span class="EmphasisFontCategoryNonProportional ">WebMvcLinkBuilder</span> class.</p>

          <p class="Para" id="Par89">You use the <span class="EmphasisFontCategoryNonProportional ">ModelMapper</span> to implicitly map a HATEOAS <span class="EmphasisFontCategoryNonProportional ">Product</span> instance to a non-HATEOAS <span class="EmphasisFontCategoryNonProportional ">Product</span> API instance. When the map method is called, the source and target types are analyzed to determine which properties implicitly match. Data is then mapped according to these matches. Even when the source and target objects and their properties are different, <span class="EmphasisFontCategoryNonProportional ">ModelMapper</span> can do its best to determine reasonable matches between properties if a configured matching strategy exists.</p>

          <p class="Para" id="Par90">Again, for brevity, I do not list the rest of the methods for the <span class="EmphasisFontCategoryNonProportional ">ProductRestController</span>. You can refer to them in the code repository.</p>

        </section>

        <section class="Section2 RenderAsSection2" id="Sec19">

          <h3 class="Heading">Build and Run the Microservice</h3>

          <div class="Para" id="Par91">The <span class="EmphasisFontCategoryNonProportional ">ch02\ch02-03</span> folder contains the Maven scripts required to <span id="ITerm37">build</span> the examples. As a first step, you need to bring up the MongoDB server. Refer to Appendix B to learn how to set up MongoDB server and bring it up. You need to execute the commands shown in Listing <span class="InternalRef"><a href="#PC27">2-26</a></span> to bring up MongoDB.<div class="ProgramCode" id="PC27"><div class="LineGroup"><div class="FixedLine">(base) binildass-MBP:bin binil$ pwd</div><div class="FixedLine">/Users/binil/Applns/mongodb/mongodb-macos-x86_64-4.2.8/bin</div><div class="FixedLine">(base) binildass-MBP:bin binil$ mongod --dbpath /usr/local/var/mongodb --logpath /usr/local/var/log/mongodb/mongo.log</div></div><div class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Listing 2-26</span><p class="SimplePara">Bringing up the MongoDB Server</p></div></div></div></div>

          <div class="Para" id="Par92">Next, take two command terminals and change the directory to the top-level folder of both microservices. Build and run the Product Server microservice using the <span class="EmphasisFontCategoryNonProportional ">make.sh</span> and the <span class="EmphasisFontCategoryNonProportional ">run.sh</span> scripts, as shown in Listing <span class="InternalRef"><a href="#PC28">2-27</a></span>.<div class="ProgramCode" id="PC28"><div class="LineGroup"><div class="FixedLine">(base) binildass-MBP:01-ProductServer binil$ pwd</div><div class="FixedLine">/Users/binil/binil/code/mac/mybooks/docker-03/ch02/ch02-03/01-ProductServer</div><div class="FixedLine">(base) binildass-MBP:01-ProductServer binil$ sh make.sh</div><div class="FixedLine">[INFO] Scanning for projects...</div><div class="FixedLine">[INFO]</div><div class="FixedLine">...</div><div class="FixedLine">2023-12-20 10:33:45 INFO  InitComponent.init:42 - Start</div><div class="FixedLine">2023-12-20 10:33:45 INFO  InitComponent.init:62 - End</div><div class="FixedLine">2023-12-20 10:33:45 INFO  Start.log:56 - Started EcomProd...</div></div><div class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Listing 2-27</span><p class="SimplePara">Build and Run Product Server Microservice Using Scripts</p></div></div></div></div>

          <div class="Para" id="Par93">Next, build and run the Product Web microservice, as shown in Listing <span class="InternalRef"><a href="#PC29">2-28</a></span>.<div class="ProgramCode" id="PC29"><div class="LineGroup"><div class="FixedLine">(base) binildass-MBP:02-ProductWeb binil$ pwd</div><div class="FixedLine">/Users/binil/binil/code/mac/mybooks/docker-03/ch02/ch02-03/02-ProductWeb</div><div class="FixedLine">(base) binildass-MBP:02-ProductWeb binil$ sh make.sh</div><div class="FixedLine">[INFO] Scanning for projects...</div><div class="FixedLine">[INFO]</div><div class="FixedLine">...</div><div class="FixedLine">2023-12-20 10:36:29 INFO  InitComponent.init:37 - Start</div><div class="FixedLine">2023-12-20 10:36:29 DEBUG InitComponent.init:39 - Do Nothing</div><div class="FixedLine">2023-12-20 10:36:29 INFO  InitComponent.init:41 - End</div><div class="FixedLine">2023-12-20 10:36:29 INFO  Start.log:56 - Started EcomProd...</div></div><div class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Listing 2-28</span><p class="SimplePara">Build and Run Product Web Microservice Using Scripts</p></div></div></div></div>

          <p class="Para" id="Par94">Now that the microservices are up and running, you can test the microservices.</p>

        </section>

        <section class="Section2 RenderAsSection2" id="Sec20">

          <h3 class="Heading">Testing the Microservice</h3>

          <p class="Para" id="Par95">Once both microservices are up and running, you can access the web application using your <span id="ITerm38">browser</span><span id="ITerm39"></span> and pointing to this URL:</p>

          <p class="Para ParaOneEmphasisChild" id="Par96"><span class="EmphasisFontCategoryNonProportional ">http://localhost:8080/product.html</span></p>

          <p class="Para" id="Par97">To test the CRUD operations, follow the instructions described in the subsection, “Test the Microservices Using UI” in the last section of Chapter <span class="ExternalRef"><a href="Capítulo-03.html"><span class="RefSource">1</span></a></span>, titled “Your First Java Microservice.”</p>

          <p class="Para" id="Par98">Recall that you enabled the HAL browser, so Spring will auto-configure the browser and make it available via the default endpoint (see Figure <span class="InternalRef"><a href="#Fig3">2-3</a></span>). You can access the HAL browser at:</p>

          <div class="Para" id="Par99"><span class="EmphasisFontCategoryNonProportional ">http://localhost:8081/</span><figure class="Figure" id="Fig3"><div class="MediaObject" id="MO3"><img alt="" aria-describedby="d64e2276" src="../images/619782_1_En_2_Chapter/Imagem-026.jpg" style="width:35.15em"/><div class="TextObject" id="d64e2276"><p class="Para" id="Par104">A screenshot of the HAL explorer window. It has the edit headers bar with the go button and the links table with 5 columns of relation, name, title, H T T P, and doc, and 2 rows of data on the left, and the response status, response headers, and response body sections with their respective data and codes on the right.</p></div></div><figcaption class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Figure 2-3</span><p class="SimplePara">The HAL browser</p></div></figcaption></figure></div>

          <p class="Para" id="Par100">You can now try the various options with the HAL browser.</p>

        </section>

      </section>

      <section class="Section1 RenderAsSection1" id="Sec21">

        <h2 class="Heading">Summary</h2>

        <p class="Para" id="Par101">In Chapter <span class="ExternalRef"><a href="Capítulo-03.html"><span class="RefSource">1</span></a></span>, you saw examples of the hexagonal architecture. This chapter continued that discussion, with more complex microservice examples. You also saw more examples of ports and adapters. By now, you should be able to relate these concepts to the many interfaces you use to expose services at the edge as well as many other interfaces you use to invoke other services from the edge (of microservices). This notion of ports and adapters provided by the hexagonal architecture is a great way to think the loosely coupled way of inter-microservice interactions too. You saw how a <span class="EmphasisFontCategoryNonProportional ">Feign</span> client provides for that in a smart manner with very little application-specific code. To complete this discussion on flexibility and loose coupling, the chapter also covered HATEOAS. The next chapter moves on to more interesting aspects in component-based architectures</p>

      </section>

    </div>

  </div>

</body>

</html>